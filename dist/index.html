<!doctype html>
<html>
  <head>
    <title>Todo List</title>
    <meta charset="UTF-8">
  </head>
  <body>
    <div id="root">
      
    </div>

    <button id="open-dialog">Open Dialog</button>
    <div id="project-form-container" class="dialog hidden" role="dialog" aria-labelledby="dialog-title">
      <div class="dialog-window">
        <h3 id="dialog-title">Project</h3>
        <form method="dialog" id="project-form">
          <label for="title">Project Title: </label>
          <input name="title" type="text" id="project-title" value="Default Project" required>
          <input type="submit" value="Save">
        </form>
      </div>
      <div class="dialog-mask"></div>
    </div>

    <script>
      const dialog = document.getElementById('project-form-container');
      const dialogWindow = dialog.querySelector('div.dialog-window');
      const dialogMask = dialog.querySelector('div.dialog-mask');
      const form = document.getElementById('project-form');
      let previousActiveElement = null;

      const openDialogBtn = document.getElementById('open-dialog');
      openDialogBtn.addEventListener('click', openDialog);


      function openDialog() {
        // Save active elemtn
        previousActiveElement = document.activeElement;

        // Show the dialog
        dialog.classList.add('opened');

        // Listen for form completion
        form.addEventListener('submit', submitForm);

        // Add listeners to close window
        dialogMask.addEventListener('click', closeDialog);
        window.addEventListener('keydown', checkCloseDialog);
        // TODO: Close button
      }

      function submitForm(e) {
        console.log('form submitted!');
        e.preventDefault();
        closeDialog();
      }

      function checkCloseDialog(e) {
        if (e.keyCode === 27) closeDialog();
      }

      function closeDialog() {
        // Remove event listeners
        dialogMask.removeEventListener('click', closeDialog);
        window.removeEventListener('keydown', checkCloseDialog);
        form.removeEventListener('submit', submitForm);

        dialog.classList.remove('opened');

        // Return focus outside of the modal
        previousActiveElement.focus();
      }
    </script>
    <script src="bundle.js"></script>
  </body>
</html>